<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>ÊõºË∞∑Ë°åÁ®ãÊü•Ë©¢ÔΩúËá™Áî® Today ModeÔºàThai TextileÔºâ</title>

  <!-- Thai fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@600;800&family=Sarabun:wght@400;600;800&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg: #fff6e8;
      --bg2:#f7fbff;

      --text:#1b2430;
      --muted:#5f6b7a;

      --thai-gold:#c9a227;     /* ÂØ∫ÂªüÈáë */
      --thai-gold2:#e7cf86;    /* ÈáëÁÆî‰∫Æ */
      --thai-teal:#0f766e;     /* Â≠îÈõÄËóç */
      --thai-red:#b42318;      /* Êú±Á¥Ö */
      --thai-ink:#111827;

      --card-bg:#ffffff;
      --border: rgba(17,24,39,0.10);

      --shadow-soft: 0 12px 34px rgba(17,24,39,0.10);
      --shadow-tight: 0 10px 24px rgba(17,24,39,0.12);

      --radius-xl: 24px;
      --radius-lg: 18px;

      --sans: "Sarabun","PingFang TC","Noto Sans TC",system-ui,-apple-system,sans-serif;
      --display: "Kanit","PingFang TC","Noto Sans TC",system-ui,-apple-system,sans-serif;
    }

    *{box-sizing:border-box; -webkit-tap-highlight-color: transparent;}

    body{
      margin:0;
      font-family:var(--sans);
      color:var(--text);
      min-height:100vh;
      overflow-x:hidden;

      /* Thai textile (dense) background */
      background:
        radial-gradient(900px 460px at 18% 0%, rgba(201,162,39,0.12), transparent 62%),
        radial-gradient(780px 420px at 92% 8%, rgba(15,118,110,0.14), transparent 58%),
        radial-gradient(700px 380px at 70% 95%, rgba(180,35,24,0.10), transparent 60%),

        repeating-linear-gradient(90deg,
          rgba(17,24,39,0.04) 0px,
          rgba(17,24,39,0.04) 1px,
          transparent 1px,
          transparent 8px
        ),
        repeating-linear-gradient(0deg,
          rgba(17,24,39,0.035) 0px,
          rgba(17,24,39,0.035) 1px,
          transparent 1px,
          transparent 10px
        ),

        repeating-linear-gradient(45deg,
          rgba(15,118,110,0.05) 0px,
          rgba(15,118,110,0.05) 2px,
          transparent 2px,
          transparent 12px
        ),
        repeating-linear-gradient(-45deg,
          rgba(201,162,39,0.06) 0px,
          rgba(201,162,39,0.06) 2px,
          transparent 2px,
          transparent 12px
        ),

        repeating-conic-gradient(
          from 0deg at 50% 18%,
          rgba(201,162,39,0.035) 0 7deg,
          transparent 7deg 18deg
        ),

        linear-gradient(180deg, var(--bg) 0%, var(--bg2) 100%);
    }

    header{
      padding: 26px 20px 8px;
      text-align:center;
    }
    h1{
      margin:0;
      font-family: var(--display);
      font-size: 32px;
      font-weight: 800;
      letter-spacing: 1.2px;
      color: var(--thai-ink);
      text-shadow: 0 2px 0 rgba(231,207,134,0.45);
      line-height: 1.05;
    }
    .sub{
      margin-top: 8px;
      font-size: 13px;
      font-weight: 800;
      color: var(--muted);
    }

    .hero-bar{
      margin: 14px auto 0;
      max-width: 720px;
      border-radius: 999px;
      padding: 10px 14px;
      background: rgba(255,255,255,0.80);
      border: 1px solid rgba(201,162,39,0.35);
      box-shadow: 0 14px 34px rgba(17,24,39,0.08);
      display:flex;
      align-items:center;
      justify-content:center;
      gap:10px;
    }
    .hero-badge{
      font-weight: 900;
      font-size: 12px;
      color: var(--thai-teal);
      letter-spacing: .2px;
    }
    .hero-dot{
      width:6px;height:6px;border-radius:50%;
      background: var(--thai-gold);
    }

    .wrap{max-width:1100px; margin:0 auto; padding-bottom: 60px;}

    .search-container { padding: 0 20px 18px; }
    .search-box{
      display:flex; align-items:center; gap:10px;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.92), rgba(255,255,255,0.86)),
        repeating-linear-gradient(90deg,
          rgba(201,162,39,0.06) 0 10px,
          transparent 10px 22px
        );
      border: 1px solid rgba(201,162,39,0.40);
      border-radius: 999px;
      padding: 10px 14px;
      box-shadow: var(--shadow-soft);
      backdrop-filter: blur(8px);
    }
    .search-box input{ all:unset; flex:1; font-size: 15px; color: var(--text); }

    .pill{
      border:none;
      padding: 8px 12px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 12px;
      cursor: pointer;
      white-space: nowrap;
      background: rgba(17,24,39,0.06);
      color: var(--thai-ink);
    }
    .pill.primary{
      background: linear-gradient(90deg, var(--thai-teal), #12a39a);
      color:#fff;
      box-shadow: 0 14px 22px rgba(15,118,110,0.22);
    }
    .pill.gold{
      background: linear-gradient(90deg, var(--thai-gold2), var(--thai-gold));
      color: #1f2937;
      box-shadow: 0 14px 22px rgba(201,162,39,0.26);
    }

    .grid{ display:block; }
    .day-selector{
      display:flex; overflow-x:auto;
      padding: 0 15px 20px; gap: 10px;
      -webkit-overflow-scrolling: touch;
    }
    .day-selector::-webkit-scrollbar { display:none; }

    .daybtn{
      flex: 0 0 118px;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.94), rgba(255,255,255,0.88)),
        repeating-linear-gradient(90deg, rgba(17,24,39,0.035) 0 1px, transparent 1px 9px),
        repeating-linear-gradient(0deg, rgba(17,24,39,0.03) 0 1px, transparent 1px 11px),
        repeating-linear-gradient(45deg, rgba(201,162,39,0.06) 0 2px, transparent 2px 14px);
      border: 1px solid rgba(201,162,39,0.28);
      border-radius: 16px;
      padding: 10px;
      text-align:center;
      cursor:pointer;
      box-shadow: 0 14px 26px rgba(17,24,39,0.08);
    }
    .daybtn strong{
      display:block;
      font-family: var(--display);
      font-size: 15px;
      color: var(--thai-teal);
    }
    .daybtn small{ font-size: 11px; color: var(--muted); font-weight: 800; }
    .daybtn.active{
      background:
        linear-gradient(180deg, rgba(15,118,110,0.96), rgba(15,118,110,0.84)),
        repeating-linear-gradient(45deg,
          rgba(231,207,134,0.18) 0 2px,
          transparent 2px 10px
        );
      border-color: rgba(231,207,134,0.55);
    }
    .daybtn.active strong, .daybtn.active small{ color:#fff; }

    .main-panel{ padding: 0 20px; }

    .title-row{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      margin-bottom:4px;
    }
    .title-left{
      display:flex;
      align-items:center;
      gap:10px;
      min-width: 0;
    }
    .title-text{
      font-weight: 900;
      font-size: 20px;
      color: var(--text);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Badge base */
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding: 6px 10px;
      border-radius: 999px;
      font-weight: 900;
      font-size: 12px;
      letter-spacing: .2px;
      border: 1px solid rgba(201,162,39,0.34);
      background: rgba(255,255,255,0.78);
      backdrop-filter: blur(8px);
      box-shadow: 0 10px 20px rgba(17,24,39,0.08);
      flex: 0 0 auto;
    }
    .badge i{
      width: 14px;
      height: 14px;
      border-radius: 4px;
      display:inline-block;
      position: relative;
      overflow:hidden;
    }

    /* Old Town: temple spire */
    .badge.temple{ border-color: rgba(201,162,39,0.45); }
    .badge.temple i{
      background: linear-gradient(180deg, rgba(231,207,134,0.90), rgba(201,162,39,0.55));
    }
    .badge.temple i::before{
      content:"";
      position:absolute; inset:2px 3px 2px 3px;
      background: linear-gradient(180deg, rgba(15,118,110,0.85), rgba(15,118,110,0.35));
      clip-path: polygon(50% 0%, 66% 22%, 66% 100%, 34% 100%, 34% 22%);
    }
    .badge.temple i::after{
      content:"";
      position:absolute; left:50%; top:1px;
      width:4px; height:4px;
      transform: translateX(-50%);
      background: rgba(180,35,24,0.85);
      border-radius: 50%;
    }

    /* Riverside: wave */
    .badge.river{ border-color: rgba(15,118,110,0.45); }
    .badge.river i{
      background: linear-gradient(180deg, rgba(15,118,110,0.30), rgba(15,118,110,0.12));
    }
    .badge.river i::before{
      content:"";
      position:absolute; inset:-2px;
      background: repeating-linear-gradient(90deg, rgba(15,118,110,0.55) 0 2px, transparent 2px 6px);
      opacity: .55;
      transform: rotate(12deg);
    }
    .badge.river i::after{
      content:"";
      position:absolute; left:-2px; right:-2px; bottom:2px; height:6px;
      background: repeating-linear-gradient(90deg, rgba(201,162,39,0.55) 0 10px, transparent 10px 16px);
      opacity:.35;
    }

    /* Outskirts: rail/market grid */
    .badge.market{ border-color: rgba(180,35,24,0.35); }
    .badge.market i{
      background:
        repeating-linear-gradient(90deg, rgba(17,24,39,0.14) 0 1px, transparent 1px 5px),
        repeating-linear-gradient(0deg, rgba(17,24,39,0.12) 0 1px, transparent 1px 6px),
        linear-gradient(180deg, rgba(231,207,134,0.55), rgba(255,255,255,0.0));
    }
    .badge.market i::after{
      content:"";
      position:absolute; left:0; right:0; bottom:0; height:3px;
      background: rgba(180,35,24,0.7);
    }

    /* Textile: ari/asok */
    .badge.textile{ border-color: rgba(201,162,39,0.32); }
    .badge.textile i{
      background:
        repeating-linear-gradient(45deg, rgba(201,162,39,0.22) 0 2px, transparent 2px 8px),
        repeating-linear-gradient(-45deg, rgba(15,118,110,0.18) 0 2px, transparent 2px 9px),
        linear-gradient(180deg, rgba(255,255,255,0.85), rgba(255,255,255,0.65));
    }

    .section-header{
      display:flex; align-items:center; gap:8px;
      margin: 22px 0 12px;
      position: relative;
    }
    .section-header span{
      font-weight: 900;
      font-size: 16px;
      color: var(--thai-ink);
    }
    .section-header::after{
      content:"";
      flex:1;
      height:2px;
      margin-left: 10px;
      border-radius:999px;
      background: linear-gradient(90deg, rgba(201,162,39,0.55), rgba(15,118,110,0.35), transparent);
    }
    .dot{ width:8px; height:8px; border-radius: 999px; }

    .timeline{ display:flex; flex-direction:column; gap:12px; }

    .item-card{
      position: relative;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.96), rgba(255,255,255,0.90)),
        repeating-linear-gradient(90deg, rgba(17,24,39,0.02) 0 1px, transparent 1px 10px),
        repeating-linear-gradient(0deg, rgba(17,24,39,0.018) 0 1px, transparent 1px 12px);
      border: 1px solid rgba(201,162,39,0.38);
      border-radius: var(--radius-xl);
      box-shadow: var(--shadow-tight);
      overflow:hidden;
      will-change: transform;
    }
    .item-card::before{
      content:"";
      position:absolute;
      inset:10px;
      border-radius: calc(var(--radius-xl) - 10px);
      border: 1px dashed rgba(201,162,39,0.42);
      pointer-events:none;
      opacity: .95;
    }
    .item-card::after{
      content:"";
      position:absolute;
      inset:-1px;
      border-radius: var(--radius-xl);
      padding:1px;
      background: linear-gradient(120deg, rgba(231,207,134,0.55), rgba(201,162,39,0.28), rgba(15,118,110,0.22));
      -webkit-mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
      -webkit-mask-composite: xor;
              mask-composite: exclude;
      pointer-events:none;
    }

    .item-content{ display:grid; grid-template-columns: 70px 1fr; gap: 12px; padding: 15px; }
    .time-tag{
      background:
        linear-gradient(180deg, rgba(231,207,134,0.28), rgba(231,207,134,0.18)),
        repeating-linear-gradient(90deg, rgba(17,24,39,0.04) 0 1px, transparent 1px 8px);
      border: 1px solid rgba(201,162,39,0.22);
      border-radius: 12px;
      height: 36px;
      display:grid; place-items:center;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono","Courier New", monospace;
      font-weight: 900;
      color: var(--thai-ink);
      font-size: 13px;
    }

    .what .w{ font-weight: 900; font-size: 16px; margin-bottom: 4px; color: var(--thai-ink); }
    .what .d{ color: var(--muted); font-size: 13px; line-height: 1.55; }

    .item-footer{
      padding: 9px 15px;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.78), rgba(255,255,255,0.70)),
        repeating-linear-gradient(90deg, rgba(17,24,39,0.02) 0 1px, transparent 1px 10px),
        repeating-linear-gradient(45deg, rgba(201,162,39,0.05) 0 2px, transparent 2px 16px);
      border-top: 1px solid rgba(201,162,39,0.22);
      font-size: 11px;
      font-weight: 900;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .footer-actions{ display:flex; gap:10px; align-items:center; }
    .footer-actions a{ color: var(--thai-teal); text-decoration:none; font-weight: 900; }
    .footer-actions a:nth-child(2){ color: var(--thai-red); }
    .footer-actions a:hover{ text-decoration: underline; }

    .trans-steps{
      background: rgba(255,255,255,0.92);
      border-radius: var(--radius-xl);
      border: 1px solid rgba(201,162,39,0.20);
      box-shadow: var(--shadow-soft);
      padding: 5px 0;
      overflow:hidden;
    }
    .t-step{
      display:flex; gap: 12px;
      padding: 12px 18px;
      border-bottom: 1px solid rgba(0,0,0,0.03);
    }
    .t-step:last-child{ border-bottom:none; }
    .t-n{
      min-width: 22px; height: 22px; border-radius: 50%;
      background: rgba(15,118,110,0.88);
      color: #fff;
      display:grid; place-items:center;
      font-weight: 900; font-size: 11px;
    }
    .t-txt .a{ font-weight: 900; font-size: 13.5px; color: var(--thai-ink); display:block; }
    .t-txt .b{ font-size: 12px; color: var(--muted); margin-top: 2px; line-height: 1.45; }

    .meals-grid{ display:grid; grid-template-columns: 1fr; gap:12px; }
    .meal-box{
      background: rgba(255,255,255,0.92);
      border-radius: var(--radius-lg);
      padding: 15px;
      border: 1px solid rgba(201,162,39,0.20);
      box-shadow: 0 10px 22px rgba(17,24,39,0.06);
      position: relative;
      overflow:hidden;
    }
    .meal-type{
      position:absolute; top:-8px; left:15px;
      padding: 2px 10px;
      border-radius: 8px;
      font-size: 10px;
      font-weight: 900;
      color: #fff;
    }
    .meal-box ul{ margin: 8px 0 0; padding-left: 18px; }
    .meal-box li{ margin: 6px 0; font-size: 13.5px; }
    .meal-item-link{ color: var(--thai-teal); font-weight: 900; text-decoration: underline; cursor:pointer; }

    /* Today mode highlight */
    .item-card.next{
      outline: 2px solid rgba(201,162,39,0.45);
      box-shadow: 0 18px 34px rgba(17,24,39,0.10), 0 14px 30px rgba(201,162,39,0.16);
    }
    .item-card.next .time-tag{
      background:
        linear-gradient(180deg, rgba(231,207,134,0.36), rgba(231,207,134,0.20)),
        repeating-linear-gradient(90deg, rgba(17,24,39,0.04) 0 1px, transparent 1px 8px);
      border-color: rgba(201,162,39,0.35);
    }

    /* Bottom sheet */
    .overlay{ position:fixed; inset:0; background:rgba(0,0,0,0.34); display:none; z-index:999; }
    .sheet{
      position:fixed; left:0; right:0; bottom:0;
      background:
        linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.92)),
        repeating-linear-gradient(45deg, rgba(201,162,39,0.05) 0 2px, transparent 2px 10px);
      border-top: 7px solid var(--thai-gold);
      border-radius: 26px 26px 0 0;
      padding: 22px;
      display:none;
      z-index:1000;
      max-height: 78vh;
      overflow-y:auto;
    }
    .sheet.show, .overlay.show{ display:block; }
    .sheet-title{
      font-family: var(--display);
      font-weight: 800;
      font-size: 19px;
      color: var(--thai-ink);
      margin-bottom: 12px;
      letter-spacing: .3px;
    }
    .sheet-desc{ font-size: 14.5px; line-height: 1.7; white-space: pre-line; color: #374151; }

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 90px;
      transform: translateX(-50%);
      background: rgba(0,0,0,0.75);
      color: #fff;
      padding: 10px 12px;
      border-radius: 12px;
      font-weight: 900;
      font-size: 12px;
      max-width: 85vw;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      z-index: 2000;
    }

    @media (min-width: 920px){
      .grid{ display:grid; grid-template-columns: 240px 1fr; }
      .day-selector{ flex-direction: column; position: sticky; top: 20px; height: auto; }
      .meals-grid{ grid-template-columns: 1fr 1fr 1fr; }
    }
  </style>
</head>

<body>
  <header>
    <h1>BANGKOK TRIP</h1>
    <div class="sub">Thai Textile EditionÔΩúToday ModeÔΩúÊü•Áúã/Â∞éËà™/Ë§áË£Ω</div>

    <div class="hero-bar">
      <span class="hero-badge">Sawasdee Bangkok</span>
      <span class="hero-dot"></span>
      <span class="hero-badge">BTS / MRT / Pier Ready</span>
    </div>

    <div style="max-width:740px;margin:10px auto 0;opacity:.9">
      <svg viewBox="0 0 900 120" width="100%" height="54" aria-hidden="true">
        <path d="M60 104h780" stroke="rgba(17,24,39,0.18)" stroke-width="4" stroke-linecap="round"/>
        <path d="M210 104V70l18-10 18 10v34" fill="none" stroke="rgba(201,162,39,0.65)" stroke-width="5" stroke-linejoin="round"/>
        <path d="M450 104V42l30-18 30 18v62" fill="none" stroke="rgba(15,118,110,0.65)" stroke-width="6" stroke-linejoin="round"/>
        <path d="M450 42l30-18 30 18" fill="none" stroke="rgba(201,162,39,0.65)" stroke-width="4" stroke-linecap="round"/>
        <path d="M670 104V64l16-10 16 10v40" fill="none" stroke="rgba(201,162,39,0.65)" stroke-width="5" stroke-linejoin="round"/>
        <circle cx="450" cy="22" r="6" fill="rgba(180,35,24,0.65)"/>
      </svg>
    </div>
  </header>

  <div class="search-container">
    <div class="search-box">
      <input id="q" placeholder="Âø´ÈÄüÊêúÂ∞ãÔºàÂèØÊêúÊôØÈªû/È§êÂª≥/‰∫§ÈÄö/ÂÇôË®ªÔºâ..." oninput="handleSearch()" />
      <button id="todayBtn" class="pill primary" onclick="toggleTodayMode()">‰ªäÂ§©Ê®°ÂºèÔºöÈñã</button>
      <button class="pill gold" onclick="openHomeDir()">ÂõûÈ£ØÂ∫ó</button>
    </div>
  </div>

  <div class="wrap">
    <div class="grid">
      <div class="day-selector" id="daylist"></div>

      <main class="main-panel">
        <div class="title-row">
          <div class="title-left">
            <div id="mainTitle" class="title-text"></div>
            <div id="dayBadge" class="badge temple" style="display:none;">
              <i></i><span id="badgeText"></span>
            </div>
          </div>
        </div>

        <div id="mainNote" style="font-size: 12.5px; color: var(--muted); margin-bottom: 18px;"></div>
        <div id="content"></div>
      </main>
    </div>
  </div>

  <div class="overlay" id="overlay" onclick="closeSheet()"></div>
  <div class="sheet" id="sheet">
    <div style="display:flex; justify-content:space-between; align-items:start; gap:10px;">
      <div id="sheetTitle" class="sheet-title"></div>
      <div style="display:flex; gap:8px;">
        <button class="pill" onclick="openSheetView()">Êü•Áúã</button>
        <button class="pill" onclick="copySheetQ()">Ë§áË£Ω</button>
        <button class="pill primary" onclick="openSheetNav()">Â∞éËà™</button>
        <button class="pill" onclick="closeSheet()">ÈóúÈñâ</button>
      </div>
    </div>
    <div id="sheetDesc" class="sheet-desc"></div>
  </div>

<script>
'use strict';

/* =========================
   Utilities
========================= */
const toMapsSearch = (q) => `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(q)}`;
const toMapsDir = (q) => `https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(q)}&travelmode=transit`;

const formatDateZh = (iso) => {
  const d = new Date(iso + 'T00:00:00');
  const wk = ['Êó•','‰∏Ä','‰∫å','‰∏â','Âõõ','‰∫î','ÂÖ≠'][d.getDay()];
  const m = d.getMonth() + 1;
  const day = d.getDate();
  return `${m}/${day}Ôºà${wk}Ôºâ`;
};

const toast = (msg) => {
  const t = document.createElement('div');
  t.className = 'toast';
  t.textContent = msg;
  document.body.appendChild(t);
  setTimeout(() => { t.style.opacity = '0'; t.style.transition = 'opacity .25s'; }, 900);
  setTimeout(() => t.remove(), 1200);
};

const copyText = async (text) => {
  try{
    await navigator.clipboard.writeText(text);
    toast(`Â∑≤Ë§áË£ΩÔºö${text}`);
  }catch(e){
    const ta = document.createElement('textarea');
    ta.value = text;
    ta.style.position = 'fixed';
    ta.style.left = '-9999px';
    document.body.appendChild(ta);
    ta.select();
    document.execCommand('copy');
    document.body.removeChild(ta);
    toast(`Â∑≤Ë§áË£ΩÔºö${text}`);
  }
};

/* =========================
   Places
========================= */
const HOME = {
  name: "Metro Hotel Phahonyothin 35",
  thai: "",
  q: "Metro Hotel Phahonyothin 35, 168 Phahonyothin 35 Alley, Chatuchak, Bangkok 10900",
  address: "168 Phahonyothin 35 Alley, Chatuchak, Bangkok 10900",
  note: "Â∑∑ÂÖßÈ£ØÂ∫óÔºõÂõûÁ®ãÊôöÈñìÊ≥®ÊÑèÂ∑∑Âè£ËªäÊµÅ„ÄÇGrab ÊúÄÁ©©„ÄÇ",
  access: { bts: "BTSÔºàÂåóÂçÄÔºâ", exit: "‰æùÂ∞éËà™", lastMile: "Âá∫Á´ôÂæå Grab 5‚Äì10 ÂàÜÈêòÔºàË¶ñÂ°ûËªäÔºâ" }
};

const PLACES = {
  BKK: {
    name: "Suvarnabhumi Airport (BKK)",
    thai: "‡∏ó‡πà‡∏≤‡∏≠‡∏≤‡∏Å‡∏≤‡∏®‡∏¢‡∏≤‡∏ô‡∏™‡∏∏‡∏ß‡∏£‡∏£‡∏ì‡∏†‡∏π‡∏°‡∏¥",
    q: "Suvarnabhumi Airport (BKK)",
    address: "Suvarnabhumi Airport",
    note: "ARL Âú®Âú∞‰∏ã‰∏ÄÊ®ìÔºõÊèõÂåØÁúã SuperRich ÁâåÂÉπÂÜçÊ±∫ÂÆö„ÄÇ",
    access: { lastMile: "ARL Áõ¥ÈÅîÂ∏ÇÂçÄ" }
  },
  HOME,

  GRAND_PALACE: {
    name: "The Grand Palace Â§ßÁöáÂÆÆ",
    thai: "‡∏û‡∏£‡∏∞‡∏ö‡∏£‡∏°‡∏°‡∏´‡∏≤‡∏£‡∏≤‡∏ä‡∏ß‡∏±‡∏á",
    q: "The Grand Palace Bangkok",
    note: "ÊúçË£ùÔºöÈï∑Ë§≤/ÈÅéËÜù„ÄÅÈÅÆËÇ©ÔºõÊó©ÂéªÈÅø‰∫∫ÊΩÆ„ÄÇ",
    access: { mrt: "MRT Sanam Chai", lastMile: "Ê≠•Ë°å 10‚Äì15 ÂàÜÈêò" }
  },
  WAT_PHO: {
    name: "Wat Pho Ëá•‰ΩõÂØ∫",
    thai: "‡∏ß‡∏±‡∏î‡πÇ‡∏û‡∏ò‡∏¥‡πå",
    q: "Wat Pho Bangkok",
    note: "ÈûãÂ≠êÂ•ΩÁ©øËÑ´ÔºõÂÆ§ÂÖß‰∫∫Â§öÔºåËºïË£ù„ÄÇ",
    access: { mrt: "MRT Sanam Chai", lastMile: "Ê≠•Ë°å 10‚Äì15 ÂàÜÈêò" }
  },
  WAT_ARUN: {
    name: "Wat Arun ÈÑ≠ÁéãÂªü",
    thai: "‡∏ß‡∏±‡∏î‡∏≠‡∏£‡∏∏‡∏ì‡∏£‡∏≤‡∏ä‡∏ß‡∏£‡∏≤‡∏£‡∏≤‡∏°",
    q: "Wat Arun Bangkok",
    note: "ÂÇçÊôöÊúÄÂ•ΩÁúãÔºõÊ∏°Ëº™Âæû Tha Tien ‰∏ÄÂ∏∂Âá∫Áôº„ÄÇ",
    access: { pier: "Tha Tien / Wat Arun ferry", lastMile: "Ê∏°Ëº™ 5 ÂàÜÈêò" }
  },
  YAOWARAT: {
    name: "Yaowarat Chinatown Âîê‰∫∫Ë°ó",
    thai: "",
    q: "Yaowarat Road Chinatown Bangkok",
    note: "Â§úÊôö‰∫∫ÊΩÆÁåõÔºöÂÖàÈéñ 2‚Äì3 ÂÆ∂Ôºå‰∏çË¶ÅÁ°¨ÈëΩ„ÄÇ",
    access: { mrt: "MRT Wat Mangkon", lastMile: "Âá∫Á´ôÂç≥ÁÜ±ÂçÄ" }
  },

  MAEKLONG: { name:"Maeklong Railway Market ÁæéÂäüÈêµÈÅìÂ∏ÇÂ†¥", thai:"", q:"Maeklong Railway Market", note:"Á´ô‰ΩçÊ≥®ÊÑèÂÆâÂÖ®Á∑öÔºõÁúãÁÅ´ËªäÊôÇÈñì„ÄÇ", access:{ lastMile:"Â§öÁÇ∫ÂåÖËªä/Ë∑üÂúò" } },
  DAMNOEN: { name:"Damnoen Saduak Floating Market ‰∏πÂ´©ËééÊúµÊ∞¥‰∏äÂ∏ÇÂ†¥", thai:"", q:"Damnoen Saduak Floating Market", note:"ÂÖàÂïèÊ∏ÖÊ•öËàπÂÉπ/ÊôÇÈñìÂÜç‰∏äËàπ„ÄÇ", access:{ lastMile:"Â§öÁÇ∫ÂåÖËªä/Ë∑üÂúò" } },

  TCDC: { name:"TCDC Bangkok Ë®≠Ë®à‰∏≠ÂøÉ", thai:"", q:"TCDC Bangkok", note:"ÂÖàÁúãÂ±ïÂçÄÂãïÁ∑öÂÜçÈÄõÊõ∏/ÈÅ∏ÂìÅ„ÄÇ", access:{ lastMile:"‰æùÂ∞éËà™Ê≠•Ë°å" } },

  ICONSIAM: { name:"ICONSIAM", thai:"", q:"ICONSIAM", note:"SookSiam ÂÆ§ÂÖßÂ∏ÇÈõÜÔºåÈõ®Â§©Ë∂ÖÂ•ΩÁî®„ÄÇ", access:{ bts:"BTS Saphan Taksin (S6)", lastMile:"Êé•ÈßÅËàπ/Âè´Ëªä" } },

  ICONSIAM_PIER4: {
    name:"ICONSIAM 4ËôüÁ¢ºÈ†≠ÔºàPier 4Ôºâ",
    thai:"",
    q:"ICONSIAM Pier 4 Bangkok",
    address:"ICONSIAM, Bangkok",
    note:"ÂÖàÊâæÈÅäËàπ Check-in Ê´ÉÂè∞ÔºåÂÜç‰æùÊåáÁ§∫Âà∞ Pier 4ÔºõÂª∫Ë≠∞ÊèêÊó© 20‚Äì30 ÂàÜÈêòÂà∞„ÄÇ",
    access:{ bts:"BTS Saphan Taksin (S6)", pier:"Pier 4", lastMile:"Êé•ÈßÅËàπ/Ê≠•Ë°å‰æùÁèæÂ†¥ÊåáÁ§∫" }
  },

  ARI: { name:"Ari ÊñáÈùíÂçÄÔºàBTS AriÔºâ", thai:"", q:"Ari BTS Station Bangkok", note:"Â∑∑ÂºÑÂíñÂï°Â§öÔºåÊåë 1‚Äì2 ÈñìÂ∞±Â•Ω„ÄÇ", access:{ bts:"BTS Ari (N5)", lastMile:"Ê≠•Ë°å" } },

  MAKKHA_ASOKE: {
    name:"Makkha Health & SpaÔºàHeritage AsokeÔºâ",
    thai:"",
    q:"Makkha Health & Spa (Heritage Asoke)",
    note:"Âª∫Ë≠∞È†êÁ¥ÑÔºõÊèêÂâç 10 ÂàÜÈêòÂà∞„ÄÇÊåâÂÆåÂéª Terminal 21 ÂæàÈ†Ü„ÄÇ",
    access:{ bts:"BTS Asok (E4)", mrt:"MRT Sukhumvit", lastMile:"Ê≠•Ë°å 5‚Äì10 ÂàÜÈêò" }
  },

  TERMINAL21: {
    name:"Terminal 21 Asok",
    thai:"",
    q:"Terminal 21 Asok",
    note:"Pier 21 Âú® 5FÔºõÂÖàÊâæÂ∫ß‰ΩçÂÜçË≤∑„ÄÇ",
    access:{ bts:"BTS Asok (E4)", mrt:"MRT Sukhumvit", lastMile:"Âá∫Á´ôÂç≥Âà∞" }
  },

  PRANAKORN_BOAT: { name:"Pranakorn Boat Noodle ËàπÈ∫µ", thai:"", q:"Pranakorn Boat Noodle Victory Monument Bangkok", note:"‰ªΩÈáèÂ∞èÔºå‰∏Ä‰∫∫ 4‚Äì6 Á¢óËµ∑Ë∑≥„ÄÇ", access:{ lastMile:"‰æùÂ∞éËà™" } },
  GO_ANG: { name:"Á¥ÖÂ§ßÂì•Êµ∑ÂçóÈõûÈ£Ø Go-Ang Pratunam", thai:"", q:"Go-Ang Pratunam Chicken Rice Bangkok", note:"Â∞ñÂ≥∞ÊéíÈöäÊ≠£Â∏∏„ÄÇ", access:{ lastMile:"‰æùÂ∞éËà™" } },
  ON_LOK_YUN: { name:"ÈÇ¢Ê≥∞Ë®òÊó©È§ê On Lok Yun", thai:"", q:"On Lok Yun Bangkok", note:"ËÄÅÂ∫óÁØÄÂ•èÊÖ¢ÔºåÊîæÈ¨ÜÂêÉ„ÄÇ", access:{ lastMile:"‰æùÂ∞éËà™" } },
  KRUAA_APSORN: { name:"Krua Apsorn ÁöáÂÆ§ÊñôÁêÜ", thai:"", q:"Krua Apsorn Bangkok", note:"ËüπËÇâÁÖéËõãÂøÖÈªû„ÄÇ", access:{ lastMile:"‰æùÂ∞éËà™" } },
  GUAY_JUB: { name:"Guay Jub Ouan PochanaÔºàË±¨ÈõúÊπØÔºâ", thai:"", q:"Guay Jub Ouan Pochana Bangkok", note:"ËÉ°Ê§íÂë≥ÂæàÈáç„ÄÇ", access:{ lastMile:"‰æùÂ∞éËà™" } },
  YAOWARAT_TOAST: { name:"Yaowarat Toasted BreadÔºàÁ¢≥ÁÉ§ÂêêÂè∏Ôºâ", thai:"", q:"Yaowarat toasted bread Bangkok", note:"ÁàÜÊºøÂÅèÁîúÔºåÂÖ©‰∫∫ÂàÜ‰∏Ä‰ªΩÂâõÂ•Ω„ÄÇ", access:{ lastMile:"‰æùÂ∞éËà™" } },
  NANA_COFFEE: { name:"Nana Coffee Roasters", thai:"", q:"Nana Coffee Roasters Bangkok", note:"ÂíñÂï°Ê∞¥Ê∫ñÁ©©„ÄÇ", access:{ lastMile:"‰æùÂ∞éËà™" } },
  OR_TOR_KOR: { name:"Or Tor Kor Market È†ÇÁ¥öËæ≤Â§´Â∏ÇÂ†¥", thai:"", q:"Or Tor Kor Market Bangkok", note:"Ê∞¥ÊûúÁèæÂàáË∂ÖÂº∑ÔºõÂ∏∂ÊøïÁ¥ôÂ∑æ„ÄÇ", access:{ mrt:"MRT Kamphaeng Phet", lastMile:"Ê≠•Ë°å" } },
  PIER21: { name:"Pier 21 ÁæéÈ£üË°ó", thai:"", q:"Pier 21 Food Court Terminal 21", note:"ÂæàÊì†ÔºöÂÖàÂç°Â∫ß‰Ωç„ÄÇ", access:{ bts:"BTS Asok (E4)", mrt:"MRT Sukhumvit" } }
};

/* =========================
   Itinerary (Day badges included)
========================= */
const itinerary = [
  {
    id: 1, day: 'DAY 1', date: '2026-02-09', title: 'ÊäµÈÅîÊõºË∞∑ÔºöËêΩÂú∞ÂÆâÈ†ì',
    tag: { type:'textile', text:'Base & Settle' },
    note: 'Á¨¨‰∏ÄÊôöÈáçÈªûÔºöARL ÈÄ≤Â∏ÇÂçÄÈÅøÂ°ûËªäÔºõÊúÄÂæå‰∏ÄÊÆµÁî® Grab Áõ¥ÈÅîÈ£ØÂ∫óÊúÄÁúÅËÖ¶„ÄÇ',
    timeline: [
      { time: '18:10', place: PLACES.BKK, desc: 'Âá∫ÈóúÈ†òË°åÊùéÔºõBKK Âú∞‰∏ã‰∏ÄÊ®ìÂèØÁúã SuperRich ÂåØÁéáÂÜçÊèõ„ÄÇ' },
      { time: '20:00', place: PLACES.HOME, desc: 'ÂÖ•‰ΩèÂæåÂÖàÊää„ÄåÂõûÈ£ØÂ∫ó„ÄçÁï∂ÊàêÂõ∫ÂÆöÂø´Êç∑Èçµ„ÄÇ' }
    ],
    meals: {
      breakfast: [{ place: PLACES.BKK, d: 'Ê©ü‰∏äËºïÈ£üÔºöÂÖà‰øùÈ´îÂäõ„ÄÇ' }],
      lunch: [{ place: PLACES.BKK, d: 'Ê©ü‰∏ä‰∏ªÈ£üÔºö‰∏ãÊ©üÂæåÂÜçÊà∞„ÄÇ' }],
      dinner: [
        { place: PLACES.PRANAKORN_BOAT, d: 'ÂãùÂà©Á¥ÄÂøµÁ¢ëÂêçÂ∫óÔºõËàπÈ∫µ‰ªΩÈáèÂ∞èÔºåÂª∫Ë≠∞‰∏ÄÂè£Ê∞£ÈªûË∂≥„ÄÇ' },
        { place: PLACES.GO_ANG, d: 'Go-Ang PratunamÔºöÊµ∑ÂçóÈõûÈ£ØÔºãËã¶ÁìúÊéíÈ™®ÊπØ„ÄÇ' }
      ]
    },
    transport: {
      headline: 'Ê©üÂ†¥ÈÄ≤Â∏ÇÂçÄÔºàËá™Áî®‰øùÂëΩÁâàÔºâ',
      steps: [
        { a: 'BKK ‚Üí ARL', b: 'Âú∞‰∏ã‰∏ÄÊ®ìÊê≠ ARL Âà∞ Phaya Thai„ÄÇ' },
        { a: 'Â∏ÇÂçÄ ‚Üí È£ØÂ∫ó', b: 'ËªåÈÅì‰∫§ÈÄöÂà∞ÂåóÂçÄÂæåÔºåÊúÄÂæå‰∏ÄÊÆµÁî® Grab ÈÄ≤ Phahonyothin 35 Alley„ÄÇ' }
      ]
    }
  },

  {
    id: 2, day: 'DAY 2', date: '2026-02-10', title: 'ËÄÅÂüéÁ∂ìÂÖ∏ËàáÈÑ≠ÁéãÂªü',
    tag: { type:'temple', text:'Old Town' },
    note: 'ËÄÅÂüéÊ†∏ÂøÉÔºöÊó©ÂéªÂ§ßÁöáÂÆÆÈÅø‰∫∫ÊΩÆÔºõÈÑ≠ÁéãÂªüÂÇçÊôöÂÖâÁ∑öÊúÄÂ•Ω„ÄÇ',
    timeline: [
      { time: '09:00', place: PLACES.GRAND_PALACE, desc: 'Â§ßÁöáÂÆÆÔºöÊúçË£ù‰∏ÄÂÆöË¶ÅÈÅéËÜù/ÈÅÆËÇ©„ÄÇ' },
      { time: '13:00', place: PLACES.WAT_PHO, desc: 'Ëá•‰ΩõÂØ∫ÔºöÂÆ§ÂÖß‰∫∫Â§öÔºåËºïË£ùÁßªÂãï„ÄÇ' },
      { time: '15:30', place: PLACES.WAT_ARUN, desc: 'Ê∏°Ëº™Ë∑®Ê≤≥ÁúãÁ¢éÁì∑Â∞ñÂ°îÔºõÂÇçÊôöÊúÄÁæé„ÄÇ' },
      { time: '18:30', place: PLACES.YAOWARAT, desc: 'Âîê‰∫∫Ë°óÔºöÂÆµÂ§úÊà∞Â†¥ÔºåÂÖàÈéñÂÆö 2‚Äì3 ÂÆ∂Â∞±Â•Ω„ÄÇ' }
    ],
    meals: {
      breakfast: [{ place: PLACES.ON_LOK_YUN, d: 'ËÄÅÂºèÊó©È§êÔºãÁÖâ‰π≥ÂíñÂï°ÔºåÊ≠•Ë™øÊÖ¢ÔºåÂà•ÊÄ•„ÄÇ' }],
      lunch: [{ place: PLACES.KRUAA_APSORN, d: 'ËüπËÇâÁÖéËõãÂøÖÈªûÔºõÂ∞ñÂ≥∞ÊéíÈöäÊ≠£Â∏∏„ÄÇ' }],
      dinner: [
        { place: PLACES.GUAY_JUB, d: 'ËÉ°Ê§íÈ¶ôÂæàÈáçÔºåÁÜ±ÁÜ±ÂñùÂæàÁàΩ„ÄÇ' },
        { place: PLACES.YAOWARAT_TOAST, d: 'ÁàÜÊºøÂêêÂè∏ÂÅèÁîúÔºåÂÖ©‰∫∫ÂàÜ‰∏Ä‰ªΩÂâõÂ•Ω„ÄÇ' }
      ]
    },
    transport: {
      headline: 'ËÄÅÂüéÂçÄËΩâ‰πòÔºà‰∏çËø∑Ë∑ØÂØ´Ê≥ïÔºâ',
      steps: [
        { a: 'Âà∞ËÄÅÂüé', b: 'ÂÖàÂà∞ MRT Sanam ChaiÔºåÊ≠•Ë°åÂà∞Â§ßÁöáÂÆÆ/Ëá•‰ΩõÂØ∫„ÄÇ' },
        { a: 'ÂéªÈÑ≠ÁéãÂªü', b: 'Âà∞ Tha Tien Á¢ºÈ†≠Êê≠Ê∏°Ëº™Ë∑®Ê≤≥„ÄÇ' },
        { a: 'ÂéªÂîê‰∫∫Ë°ó', b: 'MRT Âà∞ Wat MangkonÔºàÂá∫Á´ôÂ∞±ÈÄ≤ÁÜ±ÂçÄÔºâ„ÄÇ' }
      ]
    }
  },

  {
    id: 3, day: 'DAY 3', date: '2026-02-11', title: 'ÈÉäÂçÄÂ•áËßÄËàá‰ºëÊÅØ',
    tag: { type:'market', text:'Outskirts' },
    note: 'ËªäÁ®ãÈÅ†ÔºöÂõûÁ®ãÂ°ûËªäÊòØÂ∏∏ÊÖãÔºåÊôö‰∏äÂãôÂøÖÁïôÁµ¶‰ºëÊÅØÊàñÂ∞±ËøëÂêÉ„ÄÇ',
    timeline: [
      { time: '08:30', place: PLACES.MAEKLONG, desc: 'ÁúãÁÅ´ËªäÁ©øÂ∏ÇÂ†¥ÔºõÁ´ô‰ΩçÊ≥®ÊÑèÂÆâÂÖ®Á∑ö„ÄÇ' },
      { time: '12:00', place: PLACES.DAMNOEN, desc: 'Ê∞¥‰∏äÂ∏ÇÂ†¥ÔºöÂÖàÂïèÊ∏ÖÊ•öËàπÂÉπ/ÊôÇÈñìÂÜç‰∏äËàπ„ÄÇ' }
    ],
    meals: {
      breakfast: [{ place: { name:'7-11 ÁÜ±Â£ìÂêêÂè∏', q:'7-Eleven Thailand', note:'Âø´ÈÄüË£úËÉΩÈáè„ÄÇ' }, d: 'Ê≥∞Âúã 7-11 ÂøÖÂêÉ„ÄÇ' }],
      lunch: [{ place: PLACES.DAMNOEN, d: 'Ëàπ‰∏äÁ±≥Á≤âÊπØÔºöÊ∞¥‰∏äÂ∏ÇÂ†¥ÈôêÂÆöÈ´îÈ©ó„ÄÇ' }],
      dinner: [{ place: { name:'ÊôöÈ§êÔºàÂΩàÊÄßÔºâ', q: HOME.q, note:'Â°ûËªäÂõûÂ∏ÇÂçÄÊôöÔºöÁõ¥Êé•È£ØÂ∫óÈôÑËøëÂêÉÊúÄÁ©©„ÄÇ' }, d: '‰ªäÂ§©ÁïôÂΩàÊÄßÔºåÂà•Á°¨ÊéíÈÅ†Èªû„ÄÇ' }]
    },
    transport: {
      headline: 'ÈÉäÂçÄÂæÄËøî',
      steps: [
        { a: 'Âá∫Áôº', b: 'ÂåÖËªä/Ë∑üÂúòÁÇ∫‰∏ªÔºöÊó©Âá∫ÁôºÈÅøÂ°û„ÄÇ' },
        { a: 'ÂõûÁ®ã', b: 'Â°ûËªäÊ≠£Â∏∏ÔºöÂõûÂ∏ÇÂçÄÂæåÂÖàÂõûÈ£ØÂ∫óÊ≤ñÊ¥ó„ÄÇ' }
      ]
    }
  },

  {
    id: 4, day: 'DAY 4', date: '2026-02-12', title: 'Ë®≠Ë®àÊõºË∞∑ËàáÈÅäËàπ',
    tag: { type:'river', text:'Riverside' },
    note: 'ICONSIAM ÂæàÂ§ßÔºö‰∏ãÂçà‰ª•Êé°Ë≤∑ÔºãÂÆ§ÂÖßÂ∏ÇÈõÜÁÇ∫‰∏ªÔºõÈÅäËàπ‰ª• Pier 4 ÁÇ∫Ê∫ñ„ÄÇ',
    timeline: [
      { time: '11:00', place: PLACES.TCDC, desc: 'Ë®≠Ë®à‰∏≠ÂøÉÔºöÁúãÂ±ïÔºãÈÅ∏ÂìÅÔºåÁØÄÂ•èÊîæÊÖ¢„ÄÇ' },
      { time: '15:00', place: PLACES.ICONSIAM, desc: 'SookSiam ÂÆ§ÂÖßÂ∏ÇÈõÜÔºöÈõ®Â§©‰πüËÉΩÈÄõ„ÄÇ' },
      { time: '19:45', place: PLACES.ICONSIAM_PIER4, desc: 'White Orchid Cruise ÁôªËàπÔºöÂÖà Check-in ÂÜçÂéª Pier 4„ÄÇ' }
    ],
    meals: {
      breakfast: [{ place: PLACES.HOME, d: 'È£ØÂ∫óÊó©È§êÔºöÊÖ¢ÊÖ¢ÂêÉÔºåË£úË°Ä„ÄÇ' }],
      lunch: [{ place: { name:'ÂçàÈ§êÔºàÊ≤≥Â≤∏/Â∏Ç‰∏≠ÂøÉÂΩàÊÄßÔºâ', q:'Bang Rak Bangkok restaurants', note:'‰æùÁï∂Â§©ÂãïÁ∑öÂ∞±ËøëÂêÉÊúÄÁúÅËÖ¶„ÄÇ' }, d: 'ÁïôÂΩàÊÄßÔºåÈÅøÂÖçÁÇ∫‰∫ÜÂêÉÁ°¨ÊãâËªäÁ®ã„ÄÇ' }],
      dinner: [{ place: PLACES.ICONSIAM, d: 'ÂÖàÂú® ICONSIAM Ë£úÈªûÊù±Ë•øÔºåÈÅäËàπ‰∏äÂÜçÂêÉÊ≠£È§ê„ÄÇ' }]
    },
    transport: {
      headline: 'Ê≤≥Â≤∏Ë∑ØÁ∑öÔºàÂèØÂü∑Ë°åÔºâ',
      steps: [
        { a: 'Âà∞ BTS Saphan Taksin', b: 'ÂÖàÂ∞éËà™Âà∞ Saphan TaksinÔºàS6Ôºâ„ÄÇ' },
        { a: 'Âà∞ ICONSIAM', b: 'Êé•ÈßÅËàπÊàñÂè´ËªäÁõ¥ÈÅî ICONSIAM„ÄÇ' },
        { a: 'ÁôªËàπ', b: 'Âà∞ Check-in ‚Üí ÂÜçÂà∞ Pier 4„ÄÇ' }
      ]
    }
  },

  {
    id: 5, day: 'DAY 5', date: '2026-02-13', title: 'ÊñáÈùíÊó•Â∏∏ËàáÊ≠∏Âúã',
    tag: { type:'textile', text:'Ari / Asok' },
    note: '‰ªäÂ§©ÈóúÈçµÔºöSPAÔºãTerminal 21ÔºãÊí§ÈÄÄË∑ØÁ∑ö„ÄÇÁßªÂãïÁî®ËªåÈÅìÔºãÁü≠Á®ãÂè´Ëªä„ÄÇ',
    timeline: [
      { time: '11:00', place: PLACES.ARI, desc: 'ÊñáÈùíÂ∑∑ÂºÑÔºöÊåë 1‚Äì2 ÈñìÂíñÂï°ÔºãÂ∞èÂ∫óÂ∞±Â•Ω„ÄÇ' },
      { time: '15:00', place: PLACES.MAKKHA_ASOKE, desc: 'ÊåâÂÆåÁõ¥Êé•Âéª Terminal 21 ÂêÉÊôöÈ§êÊúÄÈ†Ü„ÄÇ' },
      { time: '18:00', place: PLACES.TERMINAL21, desc: 'Pier 21ÔºöÂÖàÊê∂Â∫ß‰ΩçÂÜçË≤∑„ÄÇ' },
      { time: '20:45', place: PLACES.BKK, desc: 'Ëµ∞ ARL Êí§ÈÄÄÊúÄÁ©©ÔºõÊèêÊó©ÊäìÂá∫ÁôºÊôÇÈñì„ÄÇ' }
    ],
    meals: {
      breakfast: [{ place: PLACES.NANA_COFFEE, d: 'ÊâãÊ≤ñ/ÊãøÈêµÈÉΩÁ©©ÔºõÂà•ÈªûÂ§™Â§öÁîú„ÄÇ' }],
      lunch: [{ place: PLACES.OR_TOR_KOR, d: 'Ê∞¥ÊûúÁèæÂàáÔºöË≤∑‰∫ÜÂ∞±ÂêÉÔºåÂà•ËÉåÂ§™‰πÖ„ÄÇ' }],
      dinner: [{ place: PLACES.PIER21, d: 'ÊâìÊããË±¨ÔºãÈ£≤ÊñôÔºöÁ∞°ÂñÆÊî∂Â∞æ„ÄÇ' }]
    },
    transport: {
      headline: 'Ê≠∏ÂúãÊí§ÈÄÄÔºàËá™Áî®‰øùÂëΩÔºâ',
      steps: [
        { a: 'Ari ‚Üí Asok', b: 'BTS Âà∞ AsokÔºàÊàñËΩâ‰πòÂà∞ AsokÔºâ„ÄÇ' },
        { a: 'ÂõûÈ£ØÂ∫óÊãøË°åÊùé', b: `Áõ¥Êé•Â∞éËà™Âõû ${HOME.name}„ÄÇ` },
        { a: 'Âéª BKK', b: 'Ëµ∞ËªåÈÅìÂà∞ Phaya Thai ËΩâ ARL Âà∞ BKK„ÄÇ' }
      ]
    }
  }
];

/* =========================
   State
========================= */
let currentDayId = 2;
let todayMode = true;
let sheetPlace = null;

/* =========================
   Today Mode helpers
========================= */
const todayIso = () => new Date().toISOString().slice(0,10);
const parseTimeOnDate = (iso, hhmm) => {
  const [hh, mm] = hhmm.split(':').map(Number);
  return new Date(`${iso}T${String(hh).padStart(2,'0')}:${String(mm).padStart(2,'0')}:00`);
};
const getNextIndexForDay = (dayObj) => {
  const now = new Date();
  const iso = todayIso();
  const isToday = dayObj.date === iso;
  if(!isToday) return 0;
  for(let i=0;i<dayObj.timeline.length;i++){
    const dt = parseTimeOnDate(iso, dayObj.timeline[i].time);
    if(dt > now) return i;
  }
  return Math.max(0, dayObj.timeline.length - 1);
};

/* =========================
   Sheet
========================= */
window.openMeal = (placeObj, desc) => {
  sheetPlace = placeObj || null;
  document.getElementById('sheetTitle').textContent = placeObj?.name || '';

  const extra = [
    placeObj?.thai ? `Ê≥∞ÊñáÔºö${placeObj.thai}` : '',
    placeObj?.address ? `Âú∞ÂùÄÔºö${placeObj.address}` : '',
    placeObj?.note ? `ÊèêÁ§∫Ôºö${placeObj.note}` : '',
    placeObj?.access?.bts ? `BTSÔºö${placeObj.access.bts}` : '',
    placeObj?.access?.mrt ? `MRTÔºö${placeObj.access.mrt}` : '',
    placeObj?.access?.exit ? `Âá∫Âè£Ôºö${placeObj.access.exit}` : '',
    placeObj?.access?.pier ? `Á¢ºÈ†≠Ôºö${placeObj.access.pier}` : '',
    placeObj?.access?.lastMile ? `ÊúÄÂæå‰∏ÄÊÆµÔºö${placeObj.access.lastMile}` : ''
  ].filter(Boolean).join('\n');

  document.getElementById('sheetDesc').textContent =
    (desc || '') + (extra ? `\n\n${extra}` : '');

  document.getElementById('sheet').classList.add('show');
  document.getElementById('overlay').classList.add('show');
};

window.openSheetNav = () => {
  const q = sheetPlace?.q || sheetPlace?.name || document.getElementById('sheetTitle').textContent;
  window.open(toMapsDir(q), '_blank', 'noopener');
};
window.openSheetView = () => {
  const q = sheetPlace?.q || sheetPlace?.name || document.getElementById('sheetTitle').textContent;
  window.open(toMapsSearch(q), '_blank', 'noopener');
};
window.copySheetQ = () => {
  const q = sheetPlace?.q || sheetPlace?.name || document.getElementById('sheetTitle').textContent;
  copyText(q);
};
window.closeSheet = () => {
  sheetPlace = null;
  document.getElementById('sheet').classList.remove('show');
  document.getElementById('overlay').classList.remove('show');
};

/* =========================
   Render
========================= */
const renderAll = () => {
  // Day list
  const daylist = document.getElementById('daylist');
  daylist.innerHTML = itinerary.map(d => `
    <div class="daybtn ${d.id === currentDayId ? 'active' : ''}" onclick="selectDay(${d.id})">
      <strong>${d.day}</strong><small>${formatDateZh(d.date)}</small>
    </div>
  `).join('');

  const d = itinerary.find(x => x.id === currentDayId) || itinerary[0];
  document.getElementById('mainTitle').textContent = `${d.day}ÔΩú${d.title}`;
  document.getElementById('mainNote').textContent = d.note;

  // --- Title badge ---
  const badge = document.getElementById('dayBadge');
  const badgeText = document.getElementById('badgeText');
  if(d.tag && d.tag.type){
    badge.style.display = 'inline-flex';
    badge.className = `badge ${d.tag.type}`;
    badgeText.textContent = d.tag.text || '';
  }else{
    badge.style.display = 'none';
  }

  let html = `
    <div class="section-header">
      <div class="dot" style="background:rgba(201,162,39,0.9)"></div>
      <span>üìç Ë°åÁ®ãÂç°ÔºàÊü•Áúã / Â∞éËà™ / Ë§áË£ΩÔºâ</span>
    </div>
    <div class="timeline">
  `;

  d.timeline.forEach(it => {
    const p = it.place || { name: it.what, q: it.q || it.what, thai: "", note: "", access:{} };
    const q = p.q || p.name;

    const subLine = [
      p.thai ? `Ê≥∞ÊñáÔºö${p.thai}` : "",
      p.access?.bts ? p.access.bts : "",
      p.access?.mrt ? p.access.mrt : "",
      p.access?.exit ? `Exit ${String(p.access.exit).replace(/Exit\s*/i,'')}` : "",
      p.access?.pier ? p.access.pier : ""
    ].filter(Boolean).join(" ÔΩú ");

    const tipLine = p.note ? `ÊèêÁ§∫Ôºö${p.note}` : "";

    html += `
      <div class="item-card">
        <div class="item-content">
          <div class="time-tag">${it.time}</div>
          <div class="what">
            <div class="w">${p.name}</div>
            <div class="d">${it.desc}</div>
            ${subLine ? `<div class="d" style="margin-top:6px;font-weight:900;color:#374151;">${subLine}</div>` : ``}
            ${tipLine ? `<div class="d" style="margin-top:6px;">${tipLine}</div>` : ``}
          </div>
        </div>
        <div class="item-footer">
          <span style="color:var(--muted); font-weight:900;">Âø´ÈÄüÊìç‰Ωú</span>
          <span class="footer-actions">
            <a href="${toMapsSearch(q)}" target="_blank" rel="noopener">Êü•Áúã</a>
            <a href="${toMapsDir(q)}" target="_blank" rel="noopener">Â∞éËà™</a>
            <a href="javascript:void(0)" onclick="copyText('${q.replace(/\\/g,'\\\\').replace(/'/g,"\\'")}')">Ë§áË£Ω</a>
          </span>
        </div>
      </div>
    `;
  });

  html += `</div>`;

  // Transport
  html += `
    <div class="section-header">
      <div class="dot" style="background:rgba(15,118,110,0.9)"></div>
      <span>üöå ‰∫§ÈÄöËΩâ‰πòÔºàÂèØÂü∑Ë°åÔºâ</span>
    </div>
    <div class="trans-steps">
      <div style="padding:15px 20px 5px; font-size:12px; font-weight:900; color:var(--thai-teal)">${d.transport.headline}</div>
      ${d.transport.steps.map((s, i) => `
        <div class="t-step">
          <div class="t-n">${i+1}</div>
          <div class="t-txt"><span class="a">${s.a}</span><span class="b">${s.b}</span></div>
        </div>
      `).join('')}
    </div>
  `;

  // Meals
  html += `
    <div class="section-header">
      <div class="dot" style="background:rgba(180,35,24,0.85)"></div>
      <span>üçú ÁæéÈ£üÔºàÈªûÂêçÂ≠ó ‚Üí Sheet ‚Üí Êü•Áúã/Â∞éËà™/Ë§áË£ΩÔºâ</span>
    </div>
    <div class="meals-grid">
  `;

  const mTypes = [
    {t:'Êó©È§ê', k:'breakfast', c:'var(--thai-teal)'},
    {t:'ÂçàÈ§ê', k:'lunch', c:'rgba(201,162,39,0.95)'},
    {t:'ÊôöÈ§ê', k:'rgba(180,35,24,0.95)', c:'rgba(180,35,24,0.95)'}
  ];

  // Fix dinner label + color cleanly
  const mTypesFixed = [
    {t:'Êó©È§ê', k:'breakfast', c:'var(--thai-teal)'},
    {t:'ÂçàÈ§ê', k:'lunch', c:'rgba(201,162,39,0.95)'},
    {t:'ÊôöÈ§ê', k:'dinner', c:'rgba(180,35,24,0.95)'}
  ];

  mTypesFixed.forEach(m => {
    html += `
      <div class="meal-box">
        <div class="meal-type" style="background:${m.c}">${m.t}</div>
        <ul>
    `;
    (d.meals[m.k] || []).forEach(item => {
      const p = item.place || { name: item.n, q: item.q || item.n, note: "" };
      const safePlace = JSON.stringify(p).replace(/</g,'\\u003c');
      const safeDesc = (item.d || '').replace(/\\/g,'\\\\').replace(/'/g,"\\'").replace(/\n/g,'\\n');
      html += `<li><span class="meal-item-link" onclick="openMeal(${safePlace}, '${safeDesc}')">${p.name}</span></li>`;
    });
    html += `</ul></div>`;
  });

  html += `</div>`;

  document.getElementById('content').innerHTML = html;
};

window.selectDay = (id) => {
  currentDayId = id;
  todayMode = false;
  syncTodayBtn();
  renderAll();
};

const syncTodayBtn = () => {
  const btn = document.getElementById('todayBtn');
  btn.textContent = `‰ªäÂ§©Ê®°ÂºèÔºö${todayMode ? 'Èñã' : 'Èóú'}`;
  btn.classList.toggle('primary', todayMode);
};

window.toggleTodayMode = () => {
  todayMode = !todayMode;
  syncTodayBtn();
  if(todayMode) applyTodayMode();
  else renderAll();
};

window.openHomeDir = () => {
  window.open(toMapsDir(HOME.q), '_blank', 'noopener');
};

/* =========================
   Today Mode apply
========================= */
const applyTodayMode = () => {
  if(!todayMode) return;

  const iso = todayIso();
  const found = itinerary.find(x => x.date === iso);
  if(found){
    currentDayId = found.id;
  }
  renderAll();

  requestAnimationFrame(() => {
    const dayObj = itinerary.find(x => x.id === currentDayId);
    if(!dayObj) return;

    const idx = getNextIndexForDay(dayObj);

    // clear old next
    document.querySelectorAll('.item-card.next').forEach(el => el.classList.remove('next'));

    const cards = Array.from(document.querySelectorAll('.timeline .item-card'));
    const target = cards[idx];
    if(target){
      target.classList.add('next');
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // main note -> next stop summary (only if today exists)
    if(dayObj.date === iso){
      const it = dayObj.timeline[idx];
      const p = it.place || { name: it.what, q: it.q || it.what };
      const now = new Date();
      const dt = parseTimeOnDate(iso, it.time);
      const mins = Math.round((dt - now)/60000);
      const eta = mins > 0 ? `Á¥Ñ ${mins} ÂàÜÈêòÂæå` : 'Â∞±ÊòØÁèæÂú®/Â∑≤ÈÅé';
      document.getElementById('mainNote').textContent =
        `‰ªäÂ§©Ê®°ÂºèÔºö‰∏ã‰∏ÄÁ´ô ${it.time}ÔΩú${p.name}Ôºà${eta}Ôºâ`;
    }
  });
};

/* =========================
   Full-text search (results list)
========================= */
const placeText = (p) => {
  if(!p) return '';
  const acc = p.access || {};
  return [
    p.name, p.thai, p.q, p.address, p.note,
    acc.bts, acc.mrt, acc.exit, acc.pier, acc.lastMile
  ].filter(Boolean).join(' ');
};

const dayBlob = (d) => {
  const tl = (d.timeline || []).map(x => `${x.time} ${placeText(x.place)} ${x.desc || ''}`).join(' ');
  const tr = (d.transport?.steps || []).map(x => `${x.a} ${x.b}`).join(' ');
  const ml = ['breakfast','lunch','dinner']
    .flatMap(k => (d.meals?.[k] || []).map(x => `${placeText(x.place)} ${x.d || ''}`))
    .join(' ');
  return `${d.day} ${d.title} ${d.note} ${formatDateZh(d.date)} ${tl} ${tr} ${ml}`.toLowerCase();
};

window.handleSearch = () => {
  const q = document.getElementById('q').value.trim().toLowerCase();
  if(!q){
    if(todayMode) applyTodayMode();
    else renderAll();
    return;
  }

  // while searching, disable today mode
  todayMode = false;
  syncTodayBtn();

  const hits = itinerary
    .map(d => ({ d, blob: dayBlob(d) }))
    .filter(x => x.blob.includes(q))
    .map(x => x.d);

  if(hits.length === 0){
    document.getElementById('content').innerHTML =
      `<div style="padding:14px; color:var(--muted); font-weight:900;">Êâæ‰∏çÂà∞„Äå${q}„ÄçÁõ∏ÈóúÂÖßÂÆπ</div>`;
    return;
  }

  document.getElementById('content').innerHTML = `
    <div class="section-header"><div class="dot" style="background:rgba(231,207,134,0.9)"></div><span>üîé ÊêúÂ∞ãÁµêÊûú</span></div>
    <div class="timeline">
      ${hits.map(d => `
        <div class="item-card" onclick="selectDay(${d.id})" style="cursor:pointer;">
          <div class="item-content">
            <div class="time-tag">${d.day}</div>
            <div class="what">
              <div class="w">${d.title}</div>
              <div class="d">${formatDateZh(d.date)}ÔΩú${d.note}</div>
            </div>
          </div>
          <div class="item-footer"><span style="color:var(--muted);font-weight:900;">ÈªûÊìäÂàáÊèõÂà∞ÈÄô‰∏ÄÂ§©</span><span style="color:var(--thai-teal);font-weight:900;">‚Üó</span></div>
        </div>
      `).join('')}
    </div>
  `;
};

/* =========================
   Init
========================= */
window.onload = () => {
  syncTodayBtn();
  applyTodayMode();

  const iso = todayIso();
  const hasToday = itinerary.some(x => x.date === iso);
  if(!hasToday){
    renderAll();
  }
};
</script>
</body>
</html>